<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   width="1200"
   height="650"
   viewBox="0 0 1200 650"
   version="1.1"
   xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; fill: #2c3e50; }
      .phase-title { font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; fill: #34495e; }
      .phase-desc { font-family: Arial, sans-serif; font-size: 10px; fill: #7f8c8d; }
      .file-name { font-family: monospace; font-size: 11px; font-weight: bold; fill: #27ae60; }
      .flow-text { font-family: Arial, sans-serif; font-size: 12px; fill: #2c3e50; }
      .hardware { fill: #3498db; stroke: #2980b9; stroke-width: 2; }
      .phase1 { fill: #e74c3c; stroke: #c0392b; stroke-width: 2; }
      .phase2 { fill: #f39c12; stroke: #d68910; stroke-width: 2; }
      .phase3 { fill: #f1c40f; stroke: #f4d03f; stroke-width: 2; }
      .phase4 { fill: #2ecc71; stroke: #27ae60; stroke-width: 2; }
      .phase5 { fill: #9b59b6; stroke: #8e44ad; stroke-width: 2; }
      .data-flow { stroke: #34495e; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
    </style>
    <marker
       id="arrowhead"
       markerWidth="10"
       markerHeight="7"
       refX="10"
       refY="3.5"
       orient="auto">
      <polygon
         points="0,0 10,3.5 0,7 "
         fill="#34495e" />
    </marker>
  </defs>

  <!-- Hardware Layer -->
  <rect x="50" y="30" width="1100" height="60" class="hardware" rx="10" />
  <text x="600" y="50" text-anchor="middle" class="phase-title" fill="white">Hardware Setup</text>
  <text x="150" y="70" class="phase-desc" fill="white">RTL-SDR Blog V4</text>
  <text x="300" y="70" class="phase-desc" fill="white">Raspberry Pi 4 (4GB)</text>
  <text x="480" y="70" class="phase-desc" fill="white">7" HDMI Touchscreen</text>
  <text x="650" y="70" class="phase-desc" fill="white">3.5mm Audio</text>
  <text x="800" y="70" class="phase-desc" fill="white">DAB+ 185.36 MHz (6C)</text>
  <text x="980" y="70" class="phase-desc" fill="white">Thailand Frequencies</text>

  <!-- Phase 1: I/Q Data Acquisition -->
  <rect x="50" y="130" width="220" height="120" class="phase1" rx="8" />
  <text x="160" y="150" text-anchor="middle" class="phase-title" fill="white">Phase 1: I/Q Acquisition</text>
  <text x="160" y="170" text-anchor="middle" class="file-name" fill="#1a1a1a">lab3_1a.py / lab3_1b.py</text>
  <text x="60" y="190" class="phase-desc" fill="#1a1a1a">• pyrtlsdr direct access</text>
  <text x="60" y="205" class="phase-desc" fill="#1a1a1a">• rtl_tcp network client</text>
  <text x="60" y="220" class="phase-desc" fill="#1a1a1a">• 185.36 MHz (6C)</text>
  <text x="60" y="235" class="phase-desc" fill="#1a1a1a">• 2.048 MSPS sampling</text>

  <!-- Phase 2: ETI Processing (eti-cmdline) -->
  <rect x="344" y="130" width="220" height="120" class="phase2" rx="8" />
  <text x="454" y="150" text-anchor="middle" class="phase-title" fill="white">Phase 2: ETI Stream</text>
  <text x="454" y="170" text-anchor="middle" class="file-name" fill="#1a1a1a">lab3_2.py</text>
  <text x="354" y="190" class="phase-desc" fill="#1a1a1a">• eti-cmdline wrapper</text>
  <text x="354" y="205" class="phase-desc" fill="#1a1a1a">• Direct RTL-SDR → ETI</text>
  <text x="354" y="220" class="phase-desc" fill="#1a1a1a">• JSON station export (-J)</text>
  <text x="354" y="235" class="phase-desc" fill="#1a1a1a">• 6144 bytes/frame (24ms)</text>

  <!-- Phase 3: Service Discovery -->
  <rect x="636" y="130" width="220" height="120" class="phase3" rx="8" />
  <text x="746" y="150" text-anchor="middle" class="phase-title">Phase 3: Service Discovery</text>
  <text x="746" y="170" text-anchor="middle" class="file-name" fill="#1a1a1a">lab3_3.py</text>
  <text x="646" y="190" class="phase-desc" fill="#1a1a1a">• Load ensemble JSON</text>
  <text x="646" y="205" class="phase-desc" fill="#1a1a1a">• Parse station list</text>
  <text x="646" y="220" class="phase-desc" fill="#1a1a1a">• Create service_list.json</text>
  <text x="646" y="235" class="phase-desc" fill="#1a1a1a">• Build subchannel info</text>

  <!-- Phase 4: Audio Extraction & Playback -->
  <rect x="920" y="130" width="220" height="120" class="phase4" rx="8" />
  <text x="1030" y="150" text-anchor="middle" class="phase-title" fill="white">Phase 4: Audio Playback</text>
  <text x="1030" y="170" text-anchor="middle" class="file-name" fill="#1a1a1a">lab3_4.py</text>
  <text x="930" y="190" class="phase-desc" fill="#1a1a1a">• ni2out audio extraction</text>
  <text x="930" y="205" class="phase-desc" fill="#1a1a1a">• ffmpeg AAC decode</text>
  <text x="930" y="220" class="phase-desc" fill="#1a1a1a">• PyAudio playback</text>
  <text x="930" y="235" class="phase-desc" fill="#1a1a1a">• Mock MOT slideshow</text>

  <!-- Phase 5: GUI Application -->
  <rect x="845" y="298" width="250" height="120" class="phase5" rx="8" />
  <text x="970" y="318" text-anchor="middle" class="phase-title" fill="white">Phase 5: Complete GUI</text>
  <text x="970" y="338" text-anchor="middle" class="file-name" fill="#1a1a1a">lab3_5.py</text>
  <text x="855" y="358" class="phase-desc" fill="#1a1a1a">• PyQt5 touchscreen UI</text>
  <text x="855" y="373" class="phase-desc" fill="#1a1a1a">• Integrates DABServicePlayer</text>
  <text x="855" y="388" class="phase-desc" fill="#1a1a1a">• Spectrum analyzer</text>
  <text x="855" y="403" class="phase-desc" fill="#1a1a1a">• Audio controls + slideshow</text>

  <!-- Data Flow Arrows -->
  <path d="m 160,100 v 30" class="data-flow" />
  <text x="170" y="115" class="flow-text">RF Signal</text>

  <path d="m 270,190 h 74" class="data-flow" />
  <text x="275" y="165" class="flow-text">I/Q Stream</text>
  <text x="275" y="180" class="flow-text">2.048 MSPS</text>

  <path d="m 564,190 h 72" class="data-flow" />
  <text x="569" y="160" class="flow-text">ETI + JSON</text>
  <text x="569" y="175" class="flow-text">ensemble-ch-6C.json</text>

  <path d="m 856,190 h 64" class="data-flow" />
  <text x="867" y="165" class="flow-text">Services</text>
  <text x="867" y="180" class="flow-text">service_list.json</text>

  <path d="m 1030,250 v 48" class="data-flow" />
  <text x="1040" y="275" class="flow-text">Audio</text>

  <!-- Data Outputs Legend -->
  <rect x="50" y="470" width="1100" height="140" fill="#ffffff" stroke="#bdc3c7" stroke-width="1" rx="5" />
  <text x="600" y="495" text-anchor="middle" class="phase-title">Lab 3 Data Flow and File Outputs</text>

  <!-- Phase 1 Output -->
  <rect x="70" y="510" width="200" height="80" fill="#ffebee" stroke="#e74c3c" stroke-width="1" rx="3" />
  <text x="80" y="525" class="phase-desc" fill="#c0392b">Phase 1 Outputs:</text>
  <text x="80" y="545" class="file-name">raw_iq_data.bin</text>
  <text x="80" y="560" class="file-name">networked_iq_data.bin</text>
  <text x="80" y="575" class="phase-desc">Complex64, 2.048 MSPS</text>

  <!-- Phase 2 Output -->
  <rect x="290" y="510" width="200" height="80" fill="#fef9e7" stroke="#f39c12" stroke-width="1" rx="3" />
  <text x="300" y="525" class="phase-desc" fill="#d68910">Phase 2 Outputs:</text>
  <text x="300" y="545" class="file-name">dab_ensemble.eti</text>
  <text x="300" y="560" class="file-name">ensemble-ch-6C.json</text>
  <text x="300" y="575" class="phase-desc">ETI-NI format + metadata</text>

  <!-- Phase 3 Output -->
  <rect x="510" y="510" width="200" height="80" fill="#fffbf0" stroke="#f1c40f" stroke-width="1" rx="3" />
  <text x="520" y="525" class="phase-desc" fill="#f4d03f">Phase 3 Outputs:</text>
  <text x="520" y="545" class="file-name">service_list.json</text>
  <text x="520" y="560" class="file-name">subchannel_info.json</text>
  <text x="520" y="575" class="phase-desc">18 services discovered</text>

  <!-- Phase 4 Output -->
  <rect x="730" y="510" width="200" height="80" fill="#eafaf1" stroke="#2ecc71" stroke-width="1" rx="3" />
  <text x="740" y="525" class="phase-desc" fill="#27ae60">Phase 4 Outputs:</text>
  <text x="740" y="545" class="file-name">service_*.aac</text>
  <text x="740" y="560" class="file-name">service_*_pcm.wav</text>
  <text x="740" y="575" class="phase-desc">AAC + PCM (48kHz stereo)</text>

  <!-- Phase 5 Output -->
  <rect x="950" y="510" width="180" height="80" fill="#f4ecf7" stroke="#9b59b6" stroke-width="1" rx="3" />
  <text x="960" y="525" class="phase-desc" fill="#8e44ad">Phase 5 Output:</text>
  <text x="960" y="545" class="file-name">GUI Application</text>
  <text x="960" y="560" class="phase-desc">Complete DAB+ receiver</text>
  <text x="960" y="575" class="phase-desc">Touchscreen interface</text>

  <!-- Tools Used -->
  <rect x="50" y="280" width="500" height="160" fill="#f8f9fa" stroke="#6c757d" stroke-width="1" rx="3" />
  <text x="60" y="300" class="phase-title">External Tools and Technologies</text>
  <text x="60" y="320" class="phase-desc">• eti-cmdline: I/Q to ETI conversion (eti-stuff package)</text>
  <text x="60" y="335" class="phase-desc">• ni2out: ETI to AAC audio extraction (eti-tools package)</text>
  <text x="60" y="350" class="phase-desc">• ffmpeg: AAC to PCM WAV decoding</text>
  <text x="60" y="365" class="phase-desc">• PyAudio: Real-time audio playback</text>
  <text x="60" y="380" class="phase-desc">• PyQt5: GUI framework for touchscreen</text>
  <text x="60" y="395" class="phase-desc">• pyrtlsdr: Python RTL-SDR interface</text>
  <text x="60" y="410" class="phase-desc">• Note: MOT slideshow uses mock images (ni2out does not support MOT)</text>
  <text x="60" y="425" class="phase-desc">  Real MOT extraction: dablin_gtk or XPADxpert (Java GUI)</text>
</svg>
